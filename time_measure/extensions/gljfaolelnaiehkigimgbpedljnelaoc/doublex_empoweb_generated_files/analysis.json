{
    "extension": "/media/data2/jianjia/extension_data/unzipped_extensions/gljfaolelnaiehkigimgbpedljnelaoc/doublex_empoweb_generated_files",
    "benchmarks": {},
    "cs": {
        "direct_dangers": {},
        "indirect_dangers": {},
        "exfiltration_dangers": {}
    },
    "bp": {
        "direct_dangers": {
            "danger1": {
                "danger": "storage.local.set",
                "value": "chrome.storage.local.set(<pdg_js.node.ValueExpr object at 0x7f22ff78fbe0>)",
                "sink-param1": "{'rules':temp_rules}",
                "line": "53 - 53",
                "filename": "/media/data2/jianjia/extension_data/unzipped_extensions/gljfaolelnaiehkigimgbpedljnelaoc/doublex_empoweb_generated_files/bg.js",
                "dataflow": false,
                "param_id0": {}
            },
            "danger2": {
                "danger": "storage.local.set",
                "value": "chrome.storage.local.set(<pdg_js.node.ValueExpr object at 0x7f22ff78fe50>)",
                "sink-param1": "{'redirectUrls':redirectUrls}",
                "line": "54 - 54",
                "filename": "/media/data2/jianjia/extension_data/unzipped_extensions/gljfaolelnaiehkigimgbpedljnelaoc/doublex_empoweb_generated_files/bg.js",
                "dataflow": false,
                "param_id0": {}
            },
            "danger3": {
                "danger": "storage.local.set",
                "value": "chrome.storage.local.set(<pdg_js.node.ValueExpr object at 0x7f23a0b044c0>)",
                "sink-param1": "{'redirectUrls':''}",
                "line": "9 - 9",
                "filename": "/media/data2/jianjia/extension_data/unzipped_extensions/gljfaolelnaiehkigimgbpedljnelaoc/doublex_empoweb_generated_files/bg.js",
                "dataflow": false,
                "param_id0": {}
            }
        },
        "indirect_dangers": {
            "danger1": {
                "danger": "storage.local.get",
                "value": "chrome.storage.local.get(<pdg_js.node.ValueExpr object at 0x7f239877d370>, <pdg_js.node.FunctionExpression object at 0x7f239877d3a0>)",
                "sink-param1": "[\"rules\",\"redirectUrls\"]",
                "sink-param2": "function(result){\n\t\t\trulesArray = result;\n\t\t\tconsole.log(rulesArray);\n\t\t\tchrome.webRequest.onBeforeRequest.addListener(\n\t\t\t\trequestHandler,\n\t\t\t\t{\n\t\t\t\t\turls: result.redirectUrls,\n\t\t\t\t\ttypes: [\"main_frame\"]\n\t\t\t\t},\n\t\t\t\t[\"blocking\"]\n\t\t\t);\t\t\n\t\t}",
                "line": "80 - 91",
                "filename": "/media/data2/jianjia/extension_data/unzipped_extensions/gljfaolelnaiehkigimgbpedljnelaoc/doublex_empoweb_generated_files/bg.js",
                "dataflow": false,
                "param_id0": {}
            },
            "danger2": {
                "danger": "storage.local.get",
                "value": "chrome.storage.local.get(<pdg_js.node.ValueExpr object at 0x7f23a164b550>, <pdg_js.node.FunctionExpression object at 0x7f23a164b580>)",
                "sink-param1": "[\"user\"]",
                "sink-param2": "function(result){\n\t\t\tif(typeof result.user != \"undefined\" && typeof result.user.customer_id != \"undefined\"){\n\t\t\t\tvar customer_id = result.user.customer_id;\n\t\t\t} else{\n\t\t\t\tvar customer_id = 52857;\n\t\t\t}\n\t\t\t$.getJSON(apiBaseUrl, function (response) {\t\t\t\t\n\t\t\t\t\tvar temp_rules = [];\n\t\t\t\t\tvar redirectUrls = [];\n\t\t\t\t\tfor (var i = 0; i < response.length; ++i) {\n\t\t\t\t\t\tvar item = response[i];\n\t\t\t\t\t\titem.destination = item.destination.replace(\"{customer_id}\",customer_id);\t\t\t\t\t\t\n\t\t\t\t\t\ttemp_rules.push(item);\t\n\t\t\t\t\t\tif (/^(ht)tps?:\\/\\//i.test(item.value)) {\n\t\t\t\t\t\t\tif(item.value[item.value.length -1] == '/'){\n\t\t\t\t\t\t\t\tredirectUrls.push(item.value);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tredirectUrls.push(item.value + '/');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if(item.value.indexOf('www') != -1 ){\n\t\t\t\t\t\t\tvar tempurl = $.trim(item.value);\n\t\t\t\t\t\t\ttempurl = tempurl.replace(\"www\",\"*://www\");\n\t\t\t\t\t\t\tif(tempurl[tempurl.length -1] == '/'){\n\t\t\t\t\t\t\t\tredirectUrls.push(tempurl);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tredirectUrls.push(tempurl + '/');\n\t\t\t\t\t\t\t}\t\t\t\t\t\t\t \n\t\t\t\t\t\t}\t\t\t\t\t\n\t\t\t\t\t}\t\t\t\t\t\n\t\t\t\t\tchrome.storage.local.set({'rules':temp_rules});\n\t\t\t\t\tchrome.storage.local.set({'redirectUrls':redirectUrls});\n\t\t\t\t\tresetRedirectUrls();\t\t\t\t\n\t\t\t\t});\t\t\t\n\t\t\t\t\t\t\t\n\t\t}",
                "line": "24 - 58",
                "filename": "/media/data2/jianjia/extension_data/unzipped_extensions/gljfaolelnaiehkigimgbpedljnelaoc/doublex_empoweb_generated_files/bg.js",
                "dataflow": false,
                "param_id0": {}
            }
        },
        "exfiltration_dangers": {
            "danger1": {
                "danger": "storage.local.get",
                "value": "chrome.storage.local.get(<pdg_js.node.ValueExpr object at 0x7f239877d370>, <pdg_js.node.FunctionExpression object at 0x7f239877d3a0>)",
                "sink-param1": "[\"rules\",\"redirectUrls\"]",
                "sink-param2": "function(result){\n\t\t\trulesArray = result;\n\t\t\tconsole.log(rulesArray);\n\t\t\tchrome.webRequest.onBeforeRequest.addListener(\n\t\t\t\trequestHandler,\n\t\t\t\t{\n\t\t\t\t\turls: result.redirectUrls,\n\t\t\t\t\ttypes: [\"main_frame\"]\n\t\t\t\t},\n\t\t\t\t[\"blocking\"]\n\t\t\t);\t\t\n\t\t}",
                "line": "80 - 91",
                "filename": "/media/data2/jianjia/extension_data/unzipped_extensions/gljfaolelnaiehkigimgbpedljnelaoc/doublex_empoweb_generated_files/bg.js",
                "dataflow": false
            },
            "danger2": {
                "danger": "storage.local.get",
                "value": "chrome.storage.local.get(<pdg_js.node.ValueExpr object at 0x7f23a164b550>, <pdg_js.node.FunctionExpression object at 0x7f23a164b580>)",
                "sink-param1": "[\"user\"]",
                "sink-param2": "function(result){\n\t\t\tif(typeof result.user != \"undefined\" && typeof result.user.customer_id != \"undefined\"){\n\t\t\t\tvar customer_id = result.user.customer_id;\n\t\t\t} else{\n\t\t\t\tvar customer_id = 52857;\n\t\t\t}\n\t\t\t$.getJSON(apiBaseUrl, function (response) {\t\t\t\t\n\t\t\t\t\tvar temp_rules = [];\n\t\t\t\t\tvar redirectUrls = [];\n\t\t\t\t\tfor (var i = 0; i < response.length; ++i) {\n\t\t\t\t\t\tvar item = response[i];\n\t\t\t\t\t\titem.destination = item.destination.replace(\"{customer_id}\",customer_id);\t\t\t\t\t\t\n\t\t\t\t\t\ttemp_rules.push(item);\t\n\t\t\t\t\t\tif (/^(ht)tps?:\\/\\//i.test(item.value)) {\n\t\t\t\t\t\t\tif(item.value[item.value.length -1] == '/'){\n\t\t\t\t\t\t\t\tredirectUrls.push(item.value);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tredirectUrls.push(item.value + '/');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if(item.value.indexOf('www') != -1 ){\n\t\t\t\t\t\t\tvar tempurl = $.trim(item.value);\n\t\t\t\t\t\t\ttempurl = tempurl.replace(\"www\",\"*://www\");\n\t\t\t\t\t\t\tif(tempurl[tempurl.length -1] == '/'){\n\t\t\t\t\t\t\t\tredirectUrls.push(tempurl);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tredirectUrls.push(tempurl + '/');\n\t\t\t\t\t\t\t}\t\t\t\t\t\t\t \n\t\t\t\t\t\t}\t\t\t\t\t\n\t\t\t\t\t}\t\t\t\t\t\n\t\t\t\t\tchrome.storage.local.set({'rules':temp_rules});\n\t\t\t\t\tchrome.storage.local.set({'redirectUrls':redirectUrls});\n\t\t\t\t\tresetRedirectUrls();\t\t\t\t\n\t\t\t\t});\t\t\t\n\t\t\t\t\t\t\t\n\t\t}",
                "line": "24 - 58",
                "filename": "/media/data2/jianjia/extension_data/unzipped_extensions/gljfaolelnaiehkigimgbpedljnelaoc/doublex_empoweb_generated_files/bg.js",
                "dataflow": false
            }
        }
    }
}